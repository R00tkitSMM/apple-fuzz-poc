## CVE-2021-1881-apple-out-of-bounds read vulnerability in FontParser

This vulnerability can be reproduced on macOS Big Sur 11.1 (20C69), MacBook Pro (13-inch, 2020, Four Thunderbolt 3 ports).

We can download Font Tools on https://developer.apple.com/download/.

![](https://z3.ax1x.com/2021/05/21/gHZosH.png)

After install it we can double click poc.ttf to open it with FTXViewer.app, and FTXViewer.app crash immediately. Problem Report for FTXViewer will show up and a crash file will appear in ~/Library/Logs/DiagnosticReports/.

![](https://z3.ax1x.com/2021/05/21/gHZzQg.png)

![](https://z3.ax1x.com/2021/05/21/gHeAYV.png)

![](https://z3.ax1x.com/2021/05/21/gHeMwR.png)

The vulnerability can also be reproduced by writing a program to parse poc.ttf.

clang -o poc poc.m -framework Foundation -framework AppKit -framework CoreText -fsanitize=undefined

DYLD_INSERT_LIBRARIES=/usr/lib/libgmalloc.dylib ./poc poc.ttf

![](https://z3.ax1x.com/2021/05/21/gHeamd.png)

According to UndefinedBehaviorSanitizer this seems to be out-of-bounds read.

**It is worth noticing that I told Apple Font Tools for Xcode 12 is vulnerable but it seems that they have no intention of updating it.**
